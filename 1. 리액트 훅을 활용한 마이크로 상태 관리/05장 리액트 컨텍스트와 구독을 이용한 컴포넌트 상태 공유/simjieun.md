# 05. 리액트 컨텍스트와 구독을 이용한 컴포넌트 상태 공유
- 리액트 컨텍스트를 사용하면 각 하위 트리마다 서로 다른 값을 제공할 수 있고 구독은 불필요한 리렌더링을 막을 수 있다.
- 이번 장에서는 리액트 컨텍스트와 구독을 합친 새로운 방법을 알아보자.
- 하위 트리마다 다른 값을 가질 수 있고 불필요한 리렌더링을 피할 수 있다는 두가지 접근방식은 어느정도 규모가 있는 애플리케이션에 유용하다.

## 모듈 상태의 한계
- 모듈 상태는 리액트 컴포넌트 외부에 존재하는 전역으로 정의된 싱글턴이기 때문에 컴포넌트 트리나 하위 트리마다 다른 상태를 가질수 없다는 한계가 있다.
- Counter와 Counter2는 비슷하지만 다른점은 Counter에서는 store를 Counter2에서는 store2를 참조한다는 점이다. 더많은 스토어를 지원하려면 Counter3 또는 Counter4가 필요하다.
- Counter는 재사용이 가능하지만 모듈 상태는 리액트 외부에 정의되기 때문에 재사용이 불가하다. 이것이 모듈 상태의 한계이다.

## 컨텍스트 사용이 필요한 시점
- 공급자가 있는 예제와 공급자가 없는 예제의 차이점이 뭘까? 차이가 없다. 기본값을 사용하면 같은 결과가 나온다.
- 컨텍스트에서 적절한 기본값을 설정하는 것은 중요하다. 컨텍스트 공급자는 기본 컨텍스트 값 또는 부모 공급자가 제공하는 값이 있는 경우 이 값을 재정의하는 메소드라고 볼수있다.
- 컨텍스트를 사용한 전역 상태의 경우 트리 최상위에서 하나의 공급자만 사용할 수 있다.
- 전역 상태를 위한 컨텍스트는 서로 다른 하위 트리에 서로 다른 값을 제공해야 하는 경우에만 필요하다.

> 논리의 전제 : 모듈 상태는 전체 컴포넌트 트리에 대해 하나의 값만 제공하는게 한계
컨텍스트는 서로 다른 하위 트리에 서로 다른 값을 제공해야할때 사용해야한다

## 컨텍스트와 구독 패턴 사용하기
- codeSandbox 링크 : https://codesandbox.io/p/devbox/9rn63t?file=%2Fsrc%2F05.naive_solution_to_module_state.tsx%3A41%2C11
- 이 패턴의 핵심은 useContext와 함께 useSubscription을 사용하는 것이다.
